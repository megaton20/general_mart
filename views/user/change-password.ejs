

<%- include('./partials/navbar') %>
<%- include ('../partials/messages') %>
<main class="main">
<div class="container">

		  <a class="back-btn" href="/user/user-details"><i class="bi bi-arrow-left-circle"></i> Back</a>

             
			<div class="m-card">

							<div class=" p-1" style="margin-top: 50px;" >

								<form action="/user/reset-password" method="post" id="resetPasswordForm" onsubmit="return validatePasswordForm()">
									<div class="form-group">
									  <input type="password" class="form-control mt-2 bg-transparent text-dark" placeholder="Enter Old Password" name="oldPassword" id="oldPassword">
									  <small id="oldPasswordError" class="text-danger"></small>
									</div>
									<div class="form-group">
									  <input type="password" class="form-control mt-2 bg-transparent text-dark" placeholder="Enter New Password" name="newPasswordA" id="newPasswordA">
									  <small id="newPasswordAError" class="text-danger"></small>
									</div>
									<div class="form-group">
									  <input type="password" class="form-control mt-2 bg-transparent text-dark" placeholder="Repeat New Password" name="newPasswordB" id="newPasswordB">
									  <small id="newPasswordBError" class="text-danger"></small>
									</div>
								  
									<button class="my-btn mt-2 m-0" style="width: 100%;" type="submit">Reset Password</button>
								  </form>
							
								  

							</div>
	
			</div>

</div>
<br>
<br>
<br>
<br>
</main>


	  
<script>
	function validatePasswordForm() {
	  let isValid = true;
  
	  // Clear previous errors
	  document.querySelectorAll(".text-danger").forEach(el => el.textContent = "");
  
	  // Old Password validation
	  const oldPassword = document.getElementById("oldPassword").value.trim();
	  if (!oldPassword) {
		document.getElementById("oldPasswordError").textContent = "Old password is required.";
		isValid = false;
	  }
  
	  // New Password validation
	  const newPasswordA = document.getElementById("newPasswordA").value;
	  const newPasswordB = document.getElementById("newPasswordB").value;
	  
	  if (!newPasswordA) {
		document.getElementById("newPasswordAError").textContent = "New password is required.";
		isValid = false;
	  } else if (newPasswordA.length < 8) {
		document.getElementById("newPasswordAError").textContent = "Password must be at least 8 characters long.";
		isValid = false;
	  } else if (!/[A-Z]/.test(newPasswordA)) {
		document.getElementById("newPasswordAError").textContent = "Password must contain at least one uppercase letter.";
		isValid = false;
	  } else if (!/[a-z]/.test(newPasswordA)) {
		document.getElementById("newPasswordAError").textContent = "Password must contain at least one lowercase letter.";
		isValid = false;
	  } else if (!/[0-9]/.test(newPasswordA)) {
		document.getElementById("newPasswordAError").textContent = "Password must contain at least one digit.";
		isValid = false;
	  } else if (!/[!@#$%^&*]/.test(newPasswordA)) {
		document.getElementById("newPasswordAError").textContent = "Password must contain at least one special character (!@#$%^&*).";
		isValid = false;
	  }
  
	  // Confirm New Password validation
	  if (!newPasswordB) {
		document.getElementById("newPasswordBError").textContent = "Please repeat the new password.";
		isValid = false;
	  } else if (newPasswordA !== newPasswordB) {
		document.getElementById("newPasswordBError").textContent = "Passwords do not match.";
		isValid = false;
	  }
  
	  return isValid; // Form will submit if valid; otherwise, it won't.
	}
  </script>
		
		
